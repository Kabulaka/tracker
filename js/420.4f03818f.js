"use strict";(self["webpackChunklog_tracker"]=self["webpackChunklog_tracker"]||[]).push([[420],{8420:function(e,t,s){s.d(t,{diagram:function(){return Q}});s(560);var o=s(3075),i=s(5878),r=s(5319),n=s(2496),a=s(517);s(6842),s(1292),s(2365),s(2917),s(3867);const d="rect",c="rectWithTitle",l="start",p="end",b="divider",g="roundedWithTitle",u="note",h="noteGroup",y="statediagram",f="state",$=`${y}-${f}`,w="transition",x="note",m="note-edge",k=`${w} ${m}`,T=`${y}-${x}`,S="cluster",D=`${y}-${S}`,A="cluster-alt",v=`${y}-${A}`,B="parent",C="note",E="state",R="----",V=`${R}${C}`,N=`${R}${B}`,L="fill:none",M="fill: #333",z="c",I="text",P="normal";let W={},Y=0;const _=function(e){const t=Object.keys(e);for(const s of t)e[s]},j=function(e,t){return t.db.extract(t.db.getRootDocV2()),t.db.getClasses()};function G(e){return void 0===e||null===e?"":e.classes?e.classes.join(" "):""}function O(e="",t=0,s="",o=R){const i=null!==s&&s.length>0?`${o}${s}`:"";return`${E}-${e}${i}-${t}`}const q=(e,t,s,i,r,a)=>{const y=s.id,f=G(i[y]);if("root"!==y){let t=d;!0===s.start&&(t=l),!1===s.start&&(t=p),s.type!==o.D&&(t=s.type),W[y]||(W[y]={id:y,shape:t,description:n.e.sanitizeText(y,(0,n.c)()),classes:`${f} ${$}`});const i=W[y];s.description&&(Array.isArray(i.description)?(i.shape=c,i.description.push(s.description)):i.description.length>0?(i.shape=c,i.description===y?i.description=[s.description]:i.description=[i.description,s.description]):(i.shape=d,i.description=s.description),i.description=n.e.sanitizeTextOrArray(i.description,(0,n.c)())),1===i.description.length&&i.shape===c&&(i.shape=d),!i.type&&s.doc&&(n.l.info("Setting cluster for ",y,H(s)),i.type="group",i.dir=H(s),i.shape=s.type===o.a?b:g,i.classes=i.classes+" "+D+" "+(a?v:""));const r={labelStyle:"",shape:i.shape,labelText:i.description,classes:i.classes,style:"",id:y,dir:i.dir,domId:O(y,Y),type:i.type,padding:15,centerLabel:!0};if(s.note){const t={labelStyle:"",shape:u,labelText:s.note.text,classes:T,style:"",id:y+V+"-"+Y,domId:O(y,Y,C),type:i.type,padding:15},o={labelStyle:"",shape:h,labelText:s.note.text,classes:i.classes,style:"",id:y+N,domId:O(y,Y,B),type:"group",padding:0};Y++;const n=y+N;e.setNode(n,o),e.setNode(t.id,t),e.setNode(y,r),e.setParent(y,n),e.setParent(t.id,n);let a=y,d=t.id;"left of"===s.note.position&&(a=t.id,d=y),e.setEdge(a,d,{arrowhead:"none",arrowType:"",style:L,labelStyle:"",classes:k,arrowheadStyle:M,labelpos:z,labelType:I,thickness:P})}else e.setNode(y,r)}t&&"root"!==t.id&&(n.l.trace("Setting node ",y," to be child of its parent ",t.id),e.setParent(y,t.id)),s.doc&&(n.l.trace("Adding nodes children "),F(e,s,s.doc,i,r,!a))},F=(e,t,s,i,r,a)=>{n.l.trace("items",s),s.forEach((s=>{switch(s.stmt){case o.b:q(e,t,s,i,r,a);break;case o.D:q(e,t,s,i,r,a);break;case o.S:{q(e,t,s.state1,i,r,a),q(e,t,s.state2,i,r,a);const o={id:"edge"+Y,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:L,labelStyle:"",label:n.e.sanitizeText(s.description,(0,n.c)()),arrowheadStyle:M,labelpos:z,labelType:I,thickness:P,classes:w};e.setEdge(s.state1.id,s.state2.id,o,Y),Y++}break}}))},H=(e,t=o.c)=>{let s=t;if(e.doc)for(let o=0;o<e.doc.length;o++){const t=e.doc[o];"dir"===t.stmt&&(s=t.value)}return s},J=async function(e,t,s,o){n.l.info("Drawing state diagram (v2)",t),W={},o.db.getDirection();const{securityLevel:c,state:l}=(0,n.c)(),p=l.nodeSpacing||50,b=l.rankSpacing||50;n.l.info(o.db.getRootDocV2()),o.db.extract(o.db.getRootDocV2()),n.l.info(o.db.getRootDocV2());const g=o.db.getStates(),u=new i.k({multigraph:!0,compound:!0}).setGraph({rankdir:H(o.db.getRootDocV2()),nodesep:p,ranksep:b,marginx:8,marginy:8}).setDefaultEdgeLabel((function(){return{}}));let h;q(u,void 0,o.db.getRootDocV2(),g,o.db,!0),"sandbox"===c&&(h=(0,r.Ys)("#i"+t));const f="sandbox"===c?(0,r.Ys)(h.nodes()[0].contentDocument.body):(0,r.Ys)("body"),$=f.select(`[id="${t}"]`),w=f.select("#"+t+" g");await(0,a.r)(w,u,["barb"],y,t);const x=8;n.u.insertTitle($,"statediagramTitleText",l.titleTopMargin,o.db.getDiagramTitle());const m=$.node().getBBox(),k=m.width+2*x,T=m.height+2*x;$.attr("class",y);const S=$.node().getBBox();(0,n.i)($,T,k,l.useMaxWidth);const D=`${S.x-x} ${S.y-x} ${k} ${T}`;n.l.debug(`viewBox ${D}`),$.attr("viewBox",D);const A=document.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const i of A){const e=i.getBBox(),t=document.createElementNS("http://www.w3.org/2000/svg",d);t.setAttribute("rx",0),t.setAttribute("ry",0),t.setAttribute("width",e.width),t.setAttribute("height",e.height),i.insertBefore(t,i.firstChild)}},K={setConf:_,getClasses:j,draw:J},Q={parser:o.p,db:o.d,renderer:K,styles:o.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,o.d.clear()}}}}]);
//# sourceMappingURL=420.4f03818f.js.map