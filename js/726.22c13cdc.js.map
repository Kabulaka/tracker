{"version":3,"file":"js/726.22c13cdc.js","mappings":"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","sources":["webpack://log-tracker/./node_modules/khroma/dist/methods/luminance.js","webpack://log-tracker/./node_modules/khroma/dist/methods/is_light.js","webpack://log-tracker/./node_modules/khroma/dist/methods/is_dark.js","webpack://log-tracker/../src/diagrams/timeline/parser/timeline.jison","webpack://log-tracker/../src/diagrams/timeline/timelineDb.js","webpack://log-tracker/../src/diagrams/timeline/svgDraw.js","webpack://log-tracker/../src/diagrams/timeline/timelineRenderer.ts","webpack://log-tracker/../src/diagrams/timeline/styles.js","webpack://log-tracker/../src/diagrams/timeline/timeline-definition.ts"],"sourcesContent":["/* IMPORT */\nimport _ from '../utils/index.js';\nimport Color from '../color/index.js';\n/* MAIN */\n//SOURCE: https://planetcalc.com/7779\nconst luminance = (color) => {\n    const { r, g, b } = Color.parse(color);\n    const luminance = .2126 * _.channel.toLinear(r) + .7152 * _.channel.toLinear(g) + .0722 * _.channel.toLinear(b);\n    return _.lang.round(luminance);\n};\n/* EXPORT */\nexport default luminance;\n","/* IMPORT */\nimport luminance from './luminance.js';\n/* MAIN */\nconst isLight = (color) => {\n    return luminance(color) >= .5;\n};\n/* EXPORT */\nexport default isLight;\n","/* IMPORT */\nimport isLight from './is_light.js';\n/* MAIN */\nconst isDark = (color) => {\n    return !isLight(color);\n};\n/* EXPORT */\nexport default isDark;\n","/** mermaid\n *  https://mermaidjs.github.io/\n *  (c) 2023 Knut Sveidqvist\n *  MIT license.\n */\n%lex\n%options case-insensitive\n%x acc_title\n%x acc_descr\n%x acc_descr_multiline\n\n// Directive states\n%x open_directive type_directive arg_directive\n\n\n%%\n\n\\%\\%\\{                                                          { this.begin('open_directive'); return 'open_directive'; }\n<open_directive>((?:(?!\\}\\%\\%)[^:.])*)                          { this.begin('type_directive'); return 'type_directive'; }\n<type_directive>\":\"                                             { this.popState(); this.begin('arg_directive'); return ':'; }\n<type_directive,arg_directive>\\}\\%\\%                            { this.popState(); this.popState(); return 'close_directive'; }\n<arg_directive>((?:(?!\\}\\%\\%).|\\n)*)                            return 'arg_directive';\n\\%%(?!\\{)[^\\n]*                                                 /* skip comments */\n[^\\}]\\%\\%[^\\n]*                                                 /* skip comments */\n[\\n]+                   return 'NEWLINE';\n\\s+                     /* skip whitespace */\n\\#[^\\n]*                /* skip comments */\n\n\"timeline\"               return 'timeline';\n\"title\"\\s[^#\\n;]+       return 'title';\naccTitle\\s*\":\"\\s*                                               { this.begin(\"acc_title\");return 'acc_title'; }\n<acc_title>(?!\\n|;|#)*[^\\n]*                                    { this.popState(); return \"acc_title_value\"; }\naccDescr\\s*\":\"\\s*                                               { this.begin(\"acc_descr\");return 'acc_descr'; }\n<acc_descr>(?!\\n|;|#)*[^\\n]*                                    { this.popState(); return \"acc_descr_value\"; }\naccDescr\\s*\"{\"\\s*                                { this.begin(\"acc_descr_multiline\");}\n<acc_descr_multiline>[\\}]                       { this.popState(); }\n<acc_descr_multiline>[^\\}]*                     return \"acc_descr_multiline_value\";\n\"section\"\\s[^#:\\n;]+    return 'section';\n\n// event starting with \"==>\" keyword\n\":\"\\s[^#:\\n;]+        return 'event';\n[^#:\\n;]+               return 'period';\n\n\n<<EOF>>                 return 'EOF';\n.                       return 'INVALID';\n\n/lex\n\n%left '^'\n\n%start start\n\n%% /* language grammar */\n\nstart\n\t: timeline document 'EOF' { return $2; }\n\t| directive start\n\t;\n\ndocument\n\t: /* empty */ { $$ = [] }\n\t| document line {$1.push($2);$$ = $1}\n\t;\n\nline\n\t: SPACE statement { $$ = $2 }\n\t| statement { $$ = $1 }\n\t| NEWLINE { $$=[];}\n\t| EOF { $$=[];}\n\t;\n\ndirective\n  : openDirective typeDirective closeDirective 'NEWLINE'\n  | openDirective typeDirective ':' argDirective closeDirective 'NEWLINE'\n  ;\n\nstatement\n  : title {yy.getCommonDb().setDiagramTitle($1.substr(6));$$=$1.substr(6);}\n  | acc_title acc_title_value  { $$=$2.trim();yy.getCommonDb().setAccTitle($$); }\n  | acc_descr acc_descr_value  { $$=$2.trim();yy.getCommonDb().setAccDescription($$); }\n  | acc_descr_multiline_value { $$=$1.trim();yy.getCommonDb().setAccDescription($$); }\n  | section {yy.addSection($1.substr(8));$$=$1.substr(8);}\n  | period_statement\n  | event_statement\n  | directive\n  ;\nperiod_statement\n  : period {yy.addTask($1,0,'');$$=$1;}\n;\nevent_statement\n  : event {yy.addEvent($1.substr(2));$$=$1;}\n;\n\n\nopenDirective\n  : open_directive { yy.parseDirective('%%{', 'open_directive'); }\n  ;\n\ntypeDirective\n  : type_directive { yy.parseDirective($1, 'type_directive'); }\n  ;\n\nargDirective\n  : arg_directive { $1 = $1.trim().replace(/'/g, '\"'); yy.parseDirective($1, 'arg_directive'); }\n  ;\n\ncloseDirective\n  : close_directive { yy.parseDirective('}%%', 'close_directive', 'timeline'); }\n  ;\n\n%%\n","import { parseDirective as _parseDirective } from '../../directiveUtils';\nimport * as commonDb from '../../commonDb';\nlet currentSection = '';\nlet currentTaskId = 0;\n\nconst sections = [];\nconst tasks = [];\nconst rawTasks = [];\n\nexport const getCommonDb = () => commonDb;\n\nexport const parseDirective = (statement, context, type) => {\n  _parseDirective(this, statement, context, type);\n};\n\nexport const clear = function () {\n  sections.length = 0;\n  tasks.length = 0;\n  currentSection = '';\n  rawTasks.length = 0;\n  commonDb.clear();\n};\n\nexport const addSection = function (txt) {\n  currentSection = txt;\n  sections.push(txt);\n};\n\nexport const getSections = function () {\n  return sections;\n};\n\nexport const getTasks = function () {\n  let allItemsProcessed = compileTasks();\n  const maxDepth = 100;\n  let iterationCount = 0;\n  while (!allItemsProcessed && iterationCount < maxDepth) {\n    allItemsProcessed = compileTasks();\n    iterationCount++;\n  }\n\n  tasks.push(...rawTasks);\n\n  return tasks;\n};\n\nexport const addTask = function (period, length, event) {\n  const rawTask = {\n    id: currentTaskId++,\n    section: currentSection,\n    type: currentSection,\n    task: period,\n    score: length ? length : 0,\n    //if event is defined, then add it the events array\n    events: event ? [event] : [],\n  };\n  rawTasks.push(rawTask);\n};\n\nexport const addEvent = function (event) {\n  // fetch current task with currnetTaskId\n  const currentTask = rawTasks.find((task) => task.id === currentTaskId - 1);\n  //add event to the events array\n  currentTask.events.push(event);\n};\n\nexport const addTaskOrg = function (descr) {\n  const newTask = {\n    section: currentSection,\n    type: currentSection,\n    description: descr,\n    task: descr,\n    classes: [],\n  };\n  tasks.push(newTask);\n};\n\n/**\n * Compiles the raw tasks into a list of tasks with events\n * @returns {boolean} true if all items are processed\n * @private\n * @memberof timelineDb\n */\nconst compileTasks = function () {\n  const compileTask = function (pos) {\n    return rawTasks[pos].processed;\n  };\n\n  let allProcessed = true;\n  for (const [i, rawTask] of rawTasks.entries()) {\n    compileTask(i);\n\n    allProcessed = allProcessed && rawTask.processed;\n  }\n  return allProcessed;\n};\n\nexport default {\n  clear,\n  getCommonDb,\n  addSection,\n  getSections,\n  getTasks,\n  addTask,\n  addTaskOrg,\n  addEvent,\n  parseDirective,\n};\n","import { arc as d3arc, select } from 'd3';\nconst MAX_SECTIONS = 12;\n\nexport const drawRect = function (elem, rectData) {\n  const rectElem = elem.append('rect');\n  rectElem.attr('x', rectData.x);\n  rectElem.attr('y', rectData.y);\n  rectElem.attr('fill', rectData.fill);\n  rectElem.attr('stroke', rectData.stroke);\n  rectElem.attr('width', rectData.width);\n  rectElem.attr('height', rectData.height);\n  rectElem.attr('rx', rectData.rx);\n  rectElem.attr('ry', rectData.ry);\n\n  if (rectData.class !== undefined) {\n    rectElem.attr('class', rectData.class);\n  }\n\n  return rectElem;\n};\n\nexport const drawFace = function (element, faceData) {\n  const radius = 15;\n  const circleElement = element\n    .append('circle')\n    .attr('cx', faceData.cx)\n    .attr('cy', faceData.cy)\n    .attr('class', 'face')\n    .attr('r', radius)\n    .attr('stroke-width', 2)\n    .attr('overflow', 'visible');\n\n  const face = element.append('g');\n\n  //left eye\n  face\n    .append('circle')\n    .attr('cx', faceData.cx - radius / 3)\n    .attr('cy', faceData.cy - radius / 3)\n    .attr('r', 1.5)\n    .attr('stroke-width', 2)\n    .attr('fill', '#666')\n    .attr('stroke', '#666');\n\n  //right eye\n  face\n    .append('circle')\n    .attr('cx', faceData.cx + radius / 3)\n    .attr('cy', faceData.cy - radius / 3)\n    .attr('r', 1.5)\n    .attr('stroke-width', 2)\n    .attr('fill', '#666')\n    .attr('stroke', '#666');\n\n  /** @param {any} face */\n  function smile(face) {\n    const arc = d3arc()\n      .startAngle(Math.PI / 2)\n      .endAngle(3 * (Math.PI / 2))\n      .innerRadius(radius / 2)\n      .outerRadius(radius / 2.2);\n    //mouth\n    face\n      .append('path')\n      .attr('class', 'mouth')\n      .attr('d', arc)\n      .attr('transform', 'translate(' + faceData.cx + ',' + (faceData.cy + 2) + ')');\n  }\n\n  /** @param {any} face */\n  function sad(face) {\n    const arc = d3arc()\n      .startAngle((3 * Math.PI) / 2)\n      .endAngle(5 * (Math.PI / 2))\n      .innerRadius(radius / 2)\n      .outerRadius(radius / 2.2);\n    //mouth\n    face\n      .append('path')\n      .attr('class', 'mouth')\n      .attr('d', arc)\n      .attr('transform', 'translate(' + faceData.cx + ',' + (faceData.cy + 7) + ')');\n  }\n\n  /** @param {any} face */\n  function ambivalent(face) {\n    face\n      .append('line')\n      .attr('class', 'mouth')\n      .attr('stroke', 2)\n      .attr('x1', faceData.cx - 5)\n      .attr('y1', faceData.cy + 7)\n      .attr('x2', faceData.cx + 5)\n      .attr('y2', faceData.cy + 7)\n      .attr('class', 'mouth')\n      .attr('stroke-width', '1px')\n      .attr('stroke', '#666');\n  }\n\n  if (faceData.score > 3) {\n    smile(face);\n  } else if (faceData.score < 3) {\n    sad(face);\n  } else {\n    ambivalent(face);\n  }\n\n  return circleElement;\n};\n\nexport const drawCircle = function (element, circleData) {\n  const circleElement = element.append('circle');\n  circleElement.attr('cx', circleData.cx);\n  circleElement.attr('cy', circleData.cy);\n  circleElement.attr('class', 'actor-' + circleData.pos);\n  circleElement.attr('fill', circleData.fill);\n  circleElement.attr('stroke', circleData.stroke);\n  circleElement.attr('r', circleData.r);\n\n  if (circleElement.class !== undefined) {\n    circleElement.attr('class', circleElement.class);\n  }\n\n  if (circleData.title !== undefined) {\n    circleElement.append('title').text(circleData.title);\n  }\n\n  return circleElement;\n};\n\nexport const drawText = function (elem, textData) {\n  // Remove and ignore br:s\n  const nText = textData.text.replace(/<br\\s*\\/?>/gi, ' ');\n\n  const textElem = elem.append('text');\n  textElem.attr('x', textData.x);\n  textElem.attr('y', textData.y);\n  textElem.attr('class', 'legend');\n\n  textElem.style('text-anchor', textData.anchor);\n\n  if (textData.class !== undefined) {\n    textElem.attr('class', textData.class);\n  }\n\n  const span = textElem.append('tspan');\n  span.attr('x', textData.x + textData.textMargin * 2);\n  span.text(nText);\n\n  return textElem;\n};\n\nexport const drawLabel = function (elem, txtObject) {\n  /**\n   * @param {any} x\n   * @param {any} y\n   * @param {any} width\n   * @param {any} height\n   * @param {any} cut\n   */\n  function genPoints(x, y, width, height, cut) {\n    return (\n      x +\n      ',' +\n      y +\n      ' ' +\n      (x + width) +\n      ',' +\n      y +\n      ' ' +\n      (x + width) +\n      ',' +\n      (y + height - cut) +\n      ' ' +\n      (x + width - cut * 1.2) +\n      ',' +\n      (y + height) +\n      ' ' +\n      x +\n      ',' +\n      (y + height)\n    );\n  }\n  const polygon = elem.append('polygon');\n  polygon.attr('points', genPoints(txtObject.x, txtObject.y, 50, 20, 7));\n  polygon.attr('class', 'labelBox');\n\n  txtObject.y = txtObject.y + txtObject.labelMargin;\n  txtObject.x = txtObject.x + 0.5 * txtObject.labelMargin;\n  drawText(elem, txtObject);\n};\n\nexport const drawSection = function (elem, section, conf) {\n  const g = elem.append('g');\n\n  const rect = getNoteRect();\n  rect.x = section.x;\n  rect.y = section.y;\n  rect.fill = section.fill;\n  rect.width = conf.width;\n  rect.height = conf.height;\n  rect.class = 'journey-section section-type-' + section.num;\n  rect.rx = 3;\n  rect.ry = 3;\n  drawRect(g, rect);\n\n  _drawTextCandidateFunc(conf)(\n    section.text,\n    g,\n    rect.x,\n    rect.y,\n    rect.width,\n    rect.height,\n    { class: 'journey-section section-type-' + section.num },\n    conf,\n    section.colour\n  );\n};\n\nlet taskCount = -1;\n/**\n * Draws an actor in the diagram with the attached line\n *\n * @param {any} elem The HTML element\n * @param {any} task The task to render\n * @param {any} conf The global configuration\n */\nexport const drawTask = function (elem, task, conf) {\n  const center = task.x + conf.width / 2;\n  const g = elem.append('g');\n  taskCount++;\n  const maxHeight = 300 + 5 * 30;\n  g.append('line')\n    .attr('id', 'task' + taskCount)\n    .attr('x1', center)\n    .attr('y1', task.y)\n    .attr('x2', center)\n    .attr('y2', maxHeight)\n    .attr('class', 'task-line')\n    .attr('stroke-width', '1px')\n    .attr('stroke-dasharray', '4 2')\n    .attr('stroke', '#666');\n\n  drawFace(g, {\n    cx: center,\n    cy: 300 + (5 - task.score) * 30,\n    score: task.score,\n  });\n\n  const rect = getNoteRect();\n  rect.x = task.x;\n  rect.y = task.y;\n  rect.fill = task.fill;\n  rect.width = conf.width;\n  rect.height = conf.height;\n  rect.class = 'task task-type-' + task.num;\n  rect.rx = 3;\n  rect.ry = 3;\n  drawRect(g, rect);\n\n  let xPos = task.x + 14;\n  // task.people.forEach((person) => {\n  //   const colour = task.actors[person].color;\n\n  //   const circle = {\n  //     cx: xPos,\n  //     cy: task.y,\n  //     r: 7,\n  //     fill: colour,\n  //     stroke: '#000',\n  //     title: person,\n  //     pos: task.actors[person].position,\n  //   };\n\n  //   drawCircle(g, circle);\n  //   xPos += 10;\n  // });\n\n  _drawTextCandidateFunc(conf)(\n    task.task,\n    g,\n    rect.x,\n    rect.y,\n    rect.width,\n    rect.height,\n    { class: 'task' },\n    conf,\n    task.colour\n  );\n};\n\n/**\n * Draws a background rectangle\n *\n * @param {any} elem The html element\n * @param {any} bounds The bounds of the drawing\n */\nexport const drawBackgroundRect = function (elem, bounds) {\n  const rectElem = drawRect(elem, {\n    x: bounds.startx,\n    y: bounds.starty,\n    width: bounds.stopx - bounds.startx,\n    height: bounds.stopy - bounds.starty,\n    fill: bounds.fill,\n    class: 'rect',\n  });\n  rectElem.lower();\n};\n\nexport const getTextObj = function () {\n  return {\n    x: 0,\n    y: 0,\n    fill: undefined,\n    'text-anchor': 'start',\n    width: 100,\n    height: 100,\n    textMargin: 0,\n    rx: 0,\n    ry: 0,\n  };\n};\n\nexport const getNoteRect = function () {\n  return {\n    x: 0,\n    y: 0,\n    width: 100,\n    anchor: 'start',\n    height: 100,\n    rx: 0,\n    ry: 0,\n  };\n};\n\nconst _drawTextCandidateFunc = (function () {\n  /**\n   * @param {any} content\n   * @param {any} g\n   * @param {any} x\n   * @param {any} y\n   * @param {any} width\n   * @param {any} height\n   * @param {any} textAttrs\n   * @param {any} colour\n   */\n  function byText(content, g, x, y, width, height, textAttrs, colour) {\n    const text = g\n      .append('text')\n      .attr('x', x + width / 2)\n      .attr('y', y + height / 2 + 5)\n      .style('font-color', colour)\n      .style('text-anchor', 'middle')\n      .text(content);\n    _setTextAttrs(text, textAttrs);\n  }\n\n  /**\n   * @param {any} content\n   * @param {any} g\n   * @param {any} x\n   * @param {any} y\n   * @param {any} width\n   * @param {any} height\n   * @param {any} textAttrs\n   * @param {any} conf\n   * @param {any} colour\n   */\n  function byTspan(content, g, x, y, width, height, textAttrs, conf, colour) {\n    const { taskFontSize, taskFontFamily } = conf;\n\n    const lines = content.split(/<br\\s*\\/?>/gi);\n    for (let i = 0; i < lines.length; i++) {\n      const dy = i * taskFontSize - (taskFontSize * (lines.length - 1)) / 2;\n      const text = g\n        .append('text')\n        .attr('x', x + width / 2)\n        .attr('y', y)\n        .attr('fill', colour)\n        .style('text-anchor', 'middle')\n        .style('font-size', taskFontSize)\n        .style('font-family', taskFontFamily);\n      text\n        .append('tspan')\n        .attr('x', x + width / 2)\n        .attr('dy', dy)\n        .text(lines[i]);\n\n      text\n        .attr('y', y + height / 2.0)\n        .attr('dominant-baseline', 'central')\n        .attr('alignment-baseline', 'central');\n\n      _setTextAttrs(text, textAttrs);\n    }\n  }\n\n  /**\n   * @param {any} content\n   * @param {any} g\n   * @param {any} x\n   * @param {any} y\n   * @param {any} width\n   * @param {any} height\n   * @param {any} textAttrs\n   * @param {any} conf\n   */\n  function byFo(content, g, x, y, width, height, textAttrs, conf) {\n    const body = g.append('switch');\n    const f = body\n      .append('foreignObject')\n      .attr('x', x)\n      .attr('y', y)\n      .attr('width', width)\n      .attr('height', height)\n      .attr('position', 'fixed');\n\n    const text = f\n      .append('xhtml:div')\n      .style('display', 'table')\n      .style('height', '100%')\n      .style('width', '100%');\n\n    text\n      .append('div')\n      .attr('class', 'label')\n      .style('display', 'table-cell')\n      .style('text-align', 'center')\n      .style('vertical-align', 'middle')\n      .text(content);\n\n    byTspan(content, body, x, y, width, height, textAttrs, conf);\n    _setTextAttrs(text, textAttrs);\n  }\n\n  /**\n   * @param {any} toText\n   * @param {any} fromTextAttrsDict\n   */\n  function _setTextAttrs(toText, fromTextAttrsDict) {\n    for (const key in fromTextAttrsDict) {\n      if (key in fromTextAttrsDict) {\n        // noinspection JSUnfilteredForInLoop\n        toText.attr(key, fromTextAttrsDict[key]);\n      }\n    }\n  }\n\n  return function (conf) {\n    return conf.textPlacement === 'fo' ? byFo : conf.textPlacement === 'old' ? byText : byTspan;\n  };\n})();\n\nconst initGraphics = function (graphics) {\n  graphics\n    .append('defs')\n    .append('marker')\n    .attr('id', 'arrowhead')\n    .attr('refX', 5)\n    .attr('refY', 2)\n    .attr('markerWidth', 6)\n    .attr('markerHeight', 4)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 0,0 V 4 L6,2 Z'); // this is actual shape for arrowhead\n};\n\n/**\n * @param {string} text The text to be wrapped\n * @param {number} width The max width of the text\n */\nfunction wrap(text, width) {\n  text.each(function () {\n    var text = select(this),\n      words = text\n        .text()\n        .split(/(\\s+|<br>)/)\n        .reverse(),\n      word,\n      line = [],\n      lineHeight = 1.1, // ems\n      y = text.attr('y'),\n      dy = parseFloat(text.attr('dy')),\n      tspan = text\n        .text(null)\n        .append('tspan')\n        .attr('x', 0)\n        .attr('y', y)\n        .attr('dy', dy + 'em');\n    for (let j = 0; j < words.length; j++) {\n      word = words[words.length - 1 - j];\n      line.push(word);\n      tspan.text(line.join(' ').trim());\n      if (tspan.node().getComputedTextLength() > width || word === '<br>') {\n        line.pop();\n        tspan.text(line.join(' ').trim());\n        if (word === '<br>') {\n          line = [''];\n        } else {\n          line = [word];\n        }\n\n        tspan = text\n          .append('tspan')\n          .attr('x', 0)\n          .attr('y', y)\n          .attr('dy', lineHeight + 'em')\n          .text(word);\n      }\n    }\n  });\n}\n\nexport const drawNode = function (elem, node, fullSection, conf) {\n  const section = (fullSection % MAX_SECTIONS) - 1;\n  const nodeElem = elem.append('g');\n  node.section = section;\n  nodeElem.attr(\n    'class',\n    (node.class ? node.class + ' ' : '') + 'timeline-node ' + ('section-' + section)\n  );\n  const bkgElem = nodeElem.append('g');\n\n  // Create the wrapped text element\n  const textElem = nodeElem.append('g');\n\n  const txt = textElem\n    .append('text')\n    .text(node.descr)\n    .attr('dy', '1em')\n    .attr('alignment-baseline', 'middle')\n    .attr('dominant-baseline', 'middle')\n    .attr('text-anchor', 'middle')\n    .call(wrap, node.width);\n  const bbox = txt.node().getBBox();\n  const fontSize =\n    conf.fontSize && conf.fontSize.replace ? conf.fontSize.replace('px', '') : conf.fontSize;\n  node.height = bbox.height + fontSize * 1.1 * 0.5 + node.padding;\n  node.height = Math.max(node.height, node.maxHeight);\n  node.width = node.width + 2 * node.padding;\n\n  textElem.attr('transform', 'translate(' + node.width / 2 + ', ' + node.padding / 2 + ')');\n\n  // Create the background element\n  defaultBkg(bkgElem, node, section, conf);\n\n  return node;\n};\n\nexport const getVirtualNodeHeight = function (elem, node, conf) {\n  const textElem = elem.append('g');\n  const txt = textElem\n    .append('text')\n    .text(node.descr)\n    .attr('dy', '1em')\n    .attr('alignment-baseline', 'middle')\n    .attr('dominant-baseline', 'middle')\n    .attr('text-anchor', 'middle')\n    .call(wrap, node.width);\n  const bbox = txt.node().getBBox();\n  const fontSize =\n    conf.fontSize && conf.fontSize.replace ? conf.fontSize.replace('px', '') : conf.fontSize;\n  textElem.remove();\n  return bbox.height + fontSize * 1.1 * 0.5 + node.padding;\n};\n\nconst defaultBkg = function (elem, node, section) {\n  const rd = 5;\n  elem\n    .append('path')\n    .attr('id', 'node-' + node.id)\n    .attr('class', 'node-bkg node-' + node.type)\n    .attr(\n      'd',\n      `M0 ${node.height - rd} v${-node.height + 2 * rd} q0,-5 5,-5 h${\n        node.width - 2 * rd\n      } q5,0 5,5 v${node.height - rd} H0 Z`\n    );\n\n  elem\n    .append('line')\n    .attr('class', 'node-line-' + section)\n    .attr('x1', 0)\n    .attr('y1', node.height)\n    .attr('x2', node.width)\n    .attr('y2', node.height);\n};\n\nexport default {\n  drawRect,\n  drawCircle,\n  drawSection,\n  drawText,\n  drawLabel,\n  drawTask,\n  drawBackgroundRect,\n  getTextObj,\n  getNoteRect,\n  initGraphics,\n  drawNode,\n  getVirtualNodeHeight,\n};\n","// @ts-ignore - db not typed yet\nimport { select, Selection } from 'd3';\nimport svgDraw from './svgDraw';\nimport { log } from '../../logger';\nimport { getConfig } from '../../config';\nimport { setupGraphViewbox } from '../../setupGraphViewbox';\nimport { Diagram } from '../../Diagram';\nimport { MermaidConfig } from '../../config.type';\n\ninterface Block<TDesc, TSection> {\n  number: number;\n  descr: TDesc;\n  section: TSection;\n  width: number;\n  padding: number;\n  maxHeight: number;\n}\n\ninterface TimelineTask {\n  id: number;\n  section: string;\n  type: string;\n  task: string;\n  score: number;\n  events: string[];\n}\nexport const draw = function (text: string, id: string, version: string, diagObj: Diagram) {\n  //1. Fetch the configuration\n  const conf = getConfig();\n  // @ts-expect-error - wrong config?\n  const LEFT_MARGIN = conf.leftMargin ?? 50;\n\n  //2. Clear the diagram db before parsing\n  diagObj.db.clear?.();\n\n  //3. Parse the diagram text\n  diagObj.parser.parse(text + '\\n');\n\n  log.debug('timeline', diagObj.db);\n\n  const securityLevel = conf.securityLevel;\n  // Handle root and Document for when rendering in sandbox mode\n  let sandboxElement;\n  if (securityLevel === 'sandbox') {\n    sandboxElement = select('#i' + id);\n  }\n  const root =\n    securityLevel === 'sandbox'\n      ? // @ts-ignore d3 types are wrong\n        select(sandboxElement.nodes()[0].contentDocument.body)\n      : select('body');\n\n  // @ts-ignore d3 types are wrong\n  const svg = root.select('#' + id);\n\n  svg.append('g');\n\n  //4. Fetch the diagram data\n  // @ts-expect-error - db not typed yet\n  const tasks: TimelineTask[] = diagObj.db.getTasks();\n  // @ts-expect-error - db not typed yet\n  const title = diagObj.db.getCommonDb().getDiagramTitle();\n  log.debug('task', tasks);\n\n  //5. Initialize the diagram\n  svgDraw.initGraphics(svg);\n\n  // fetch Sections\n  // @ts-expect-error - db not typed yet\n  const sections: string[] = diagObj.db.getSections();\n  log.debug('sections', sections);\n\n  let maxSectionHeight = 0;\n  let maxTaskHeight = 0;\n  //let sectionBeginX = 0;\n  let depthY = 0;\n  let sectionBeginY = 0;\n  let masterX = 50 + LEFT_MARGIN;\n  //sectionBeginX = masterX;\n  let masterY = 50;\n  sectionBeginY = 50;\n  //draw sections\n  let sectionNumber = 0;\n  let hasSections = true;\n\n  //Calculate the max height of the sections\n  sections.forEach(function (section: string) {\n    const sectionNode: Block<string, number> = {\n      number: sectionNumber,\n      descr: section,\n      section: sectionNumber,\n      width: 150,\n      padding: 20,\n      maxHeight: maxSectionHeight,\n    };\n    const sectionHeight = svgDraw.getVirtualNodeHeight(svg, sectionNode, conf);\n    log.debug('sectionHeight before draw', sectionHeight);\n    maxSectionHeight = Math.max(maxSectionHeight, sectionHeight + 20);\n  });\n\n  //tasks length and maxEventCount\n  let maxEventCount = 0;\n  let maxEventLineLength = 0;\n  log.debug('tasks.length', tasks.length);\n  //calculate max task height\n  // for loop till tasks.length\n\n  for (const [i, task] of tasks.entries()) {\n    const taskNode: Block<TimelineTask, string> = {\n      number: i,\n      descr: task,\n      section: task.section,\n      width: 150,\n      padding: 20,\n      maxHeight: maxTaskHeight,\n    };\n    const taskHeight = svgDraw.getVirtualNodeHeight(svg, taskNode, conf);\n    log.debug('taskHeight before draw', taskHeight);\n    maxTaskHeight = Math.max(maxTaskHeight, taskHeight + 20);\n\n    //calculate maxEventCount\n    maxEventCount = Math.max(maxEventCount, task.events.length);\n    //calculate maxEventLineLength\n    let maxEventLineLengthTemp = 0;\n    for (let j = 0; j < task.events.length; j++) {\n      const event = task.events[j];\n      const eventNode = {\n        descr: event,\n        section: task.section,\n        number: task.section,\n        width: 150,\n        padding: 20,\n        maxHeight: 50,\n      };\n      maxEventLineLengthTemp += svgDraw.getVirtualNodeHeight(svg, eventNode, conf);\n    }\n    maxEventLineLength = Math.max(maxEventLineLength, maxEventLineLengthTemp);\n  }\n\n  log.debug('maxSectionHeight before draw', maxSectionHeight);\n  log.debug('maxTaskHeight before draw', maxTaskHeight);\n\n  if (sections && sections.length > 0) {\n    sections.forEach((section) => {\n      //filter task where tasks.section == section\n      const tasksForSection = tasks.filter((task) => task.section === section);\n\n      const sectionNode: Block<string, number> = {\n        number: sectionNumber,\n        descr: section,\n        section: sectionNumber,\n        width: 200 * Math.max(tasksForSection.length, 1) - 50,\n        padding: 20,\n        maxHeight: maxSectionHeight,\n      };\n      log.debug('sectionNode', sectionNode);\n      const sectionNodeWrapper = svg.append('g');\n      const node = svgDraw.drawNode(sectionNodeWrapper, sectionNode, sectionNumber, conf);\n      log.debug('sectionNode output', node);\n\n      sectionNodeWrapper.attr('transform', `translate(${masterX}, ${sectionBeginY})`);\n\n      masterY += maxSectionHeight + 50;\n\n      //draw tasks for this section\n      if (tasksForSection.length > 0) {\n        drawTasks(\n          svg,\n          tasksForSection,\n          sectionNumber,\n          masterX,\n          masterY,\n          maxTaskHeight,\n          conf,\n          maxEventCount,\n          maxEventLineLength,\n          maxSectionHeight,\n          false\n        );\n      }\n      // todo replace with total width of section and its tasks\n      masterX += 200 * Math.max(tasksForSection.length, 1);\n\n      masterY = sectionBeginY;\n      sectionNumber++;\n    });\n  } else {\n    //draw tasks\n    hasSections = false;\n    drawTasks(\n      svg,\n      tasks,\n      sectionNumber,\n      masterX,\n      masterY,\n      maxTaskHeight,\n      conf,\n      maxEventCount,\n      maxEventLineLength,\n      maxSectionHeight,\n      true\n    );\n  }\n\n  // Get BBox of the diagram\n  const box = svg.node().getBBox();\n  log.debug('bounds', box);\n\n  if (title) {\n    svg\n      .append('text')\n      .text(title)\n      .attr('x', box.width / 2 - LEFT_MARGIN)\n      .attr('font-size', '4ex')\n      .attr('font-weight', 'bold')\n      .attr('y', 20);\n  }\n  //5. Draw the diagram\n  depthY = hasSections ? maxSectionHeight + maxTaskHeight + 150 : maxTaskHeight + 100;\n\n  const lineWrapper = svg.append('g').attr('class', 'lineWrapper');\n  // Draw activity line\n  lineWrapper\n    .append('line')\n    .attr('x1', LEFT_MARGIN)\n    .attr('y1', depthY) // One section head + one task + margins\n    .attr('x2', box.width + 3 * LEFT_MARGIN) // Subtract stroke width so arrow point is retained\n    .attr('y2', depthY)\n    .attr('stroke-width', 4)\n    .attr('stroke', 'black')\n    .attr('marker-end', 'url(#arrowhead)');\n\n  // Setup the view box and size of the svg element\n  setupGraphViewbox(\n    undefined,\n    svg,\n    conf.timeline?.padding ?? 50,\n    conf.timeline?.useMaxWidth ?? false\n  );\n\n  // addSVGAccessibilityFields(diagObj.db, diagram, id);\n};\n\nexport const drawTasks = function (\n  diagram: Selection<SVGElement, unknown, null, undefined>,\n  tasks: TimelineTask[],\n  sectionColor: number,\n  masterX: number,\n  masterY: number,\n  maxTaskHeight: number,\n  conf: MermaidConfig,\n  maxEventCount: number,\n  maxEventLineLength: number,\n  maxSectionHeight: number,\n  isWithoutSections: boolean\n) {\n  // Draw the tasks\n  for (const task of tasks) {\n    // create node from task\n    const taskNode = {\n      descr: task.task,\n      section: sectionColor,\n      number: sectionColor,\n      width: 150,\n      padding: 20,\n      maxHeight: maxTaskHeight,\n    };\n\n    log.debug('taskNode', taskNode);\n    // create task wrapper\n\n    const taskWrapper = diagram.append('g').attr('class', 'taskWrapper');\n    const node = svgDraw.drawNode(taskWrapper, taskNode, sectionColor, conf);\n    const taskHeight = node.height;\n    //log task height\n    log.debug('taskHeight after draw', taskHeight);\n    taskWrapper.attr('transform', `translate(${masterX}, ${masterY})`);\n\n    // update max task height\n    maxTaskHeight = Math.max(maxTaskHeight, taskHeight);\n\n    // if task has events, draw them\n    if (task.events) {\n      // draw a line between the task and the events\n      const lineWrapper = diagram.append('g').attr('class', 'lineWrapper');\n      let lineLength = maxTaskHeight;\n      //add margin to task\n      masterY += 100;\n      lineLength =\n        lineLength + drawEvents(diagram, task.events, sectionColor, masterX, masterY, conf);\n      masterY -= 100;\n\n      lineWrapper\n        .append('line')\n        .attr('x1', masterX + 190 / 2)\n        .attr('y1', masterY + maxTaskHeight) // One section head + one task + margins\n        .attr('x2', masterX + 190 / 2) // Subtract stroke width so arrow point is retained\n        .attr(\n          'y2',\n          masterY +\n            maxTaskHeight +\n            (isWithoutSections ? maxTaskHeight : maxSectionHeight) +\n            maxEventLineLength +\n            120\n        )\n        .attr('stroke-width', 2)\n        .attr('stroke', 'black')\n        .attr('marker-end', 'url(#arrowhead)')\n        .attr('stroke-dasharray', '5,5');\n    }\n\n    masterX = masterX + 200;\n    if (isWithoutSections && !conf.timeline?.disableMulticolor) {\n      sectionColor++;\n    }\n  }\n\n  // reset Y coordinate for next section\n  masterY = masterY - 10;\n};\n\nexport const drawEvents = function (\n  diagram: Selection<SVGElement, unknown, null, undefined>,\n  events: string[],\n  sectionColor: number,\n  masterX: number,\n  masterY: number,\n  conf: MermaidConfig\n) {\n  let maxEventHeight = 0;\n  const eventBeginY = masterY;\n  masterY = masterY + 100;\n  // Draw the events\n  for (const event of events) {\n    // create node from event\n    const eventNode: Block<string, number> = {\n      descr: event,\n      section: sectionColor,\n      number: sectionColor,\n      width: 150,\n      padding: 20,\n      maxHeight: 50,\n    };\n\n    //log task node\n    log.debug('eventNode', eventNode);\n    // create event wrapper\n    const eventWrapper = diagram.append('g').attr('class', 'eventWrapper');\n    const node = svgDraw.drawNode(eventWrapper, eventNode, sectionColor, conf);\n    const eventHeight = node.height;\n    maxEventHeight = maxEventHeight + eventHeight;\n    eventWrapper.attr('transform', `translate(${masterX}, ${masterY})`);\n    masterY = masterY + 10 + eventHeight;\n  }\n  // set masterY back to eventBeginY\n  masterY = eventBeginY;\n  return maxEventHeight;\n};\n\nexport default {\n  setConf: () => {\n    // no-op\n  },\n  draw,\n};\n","import { darken, lighten, isDark } from 'khroma';\n\nconst genSections = (options) => {\n  let sections = '';\n\n  for (let i = 0; i < options.THEME_COLOR_LIMIT; i++) {\n    options['lineColor' + i] = options['lineColor' + i] || options['cScaleInv' + i];\n    if (isDark(options['lineColor' + i])) {\n      options['lineColor' + i] = lighten(options['lineColor' + i], 20);\n    } else {\n      options['lineColor' + i] = darken(options['lineColor' + i], 20);\n    }\n  }\n\n  for (let i = 0; i < options.THEME_COLOR_LIMIT; i++) {\n    const sw = '' + (17 - 3 * i);\n    sections += `\n    .section-${i - 1} rect, .section-${i - 1} path, .section-${i - 1} circle, .section-${\n      i - 1\n    } path  {\n      fill: ${options['cScale' + i]};\n    }\n    .section-${i - 1} text {\n     fill: ${options['cScaleLabel' + i]};\n    }\n    .node-icon-${i - 1} {\n      font-size: 40px;\n      color: ${options['cScaleLabel' + i]};\n    }\n    .section-edge-${i - 1}{\n      stroke: ${options['cScale' + i]};\n    }\n    .edge-depth-${i - 1}{\n      stroke-width: ${sw};\n    }\n    .section-${i - 1} line {\n      stroke: ${options['cScaleInv' + i]} ;\n      stroke-width: 3;\n    }\n\n    .lineWrapper line{\n      stroke: ${options['cScaleLabel' + i]} ;\n    }\n\n    .disabled, .disabled circle, .disabled text {\n      fill: lightgray;\n    }\n    .disabled text {\n      fill: #efefef;\n    }\n    `;\n  }\n  return sections;\n};\n\nconst getStyles = (options) =>\n  `\n  .edge {\n    stroke-width: 3;\n  }\n  ${genSections(options)}\n  .section-root rect, .section-root path, .section-root circle  {\n    fill: ${options.git0};\n  }\n  .section-root text {\n    fill: ${options.gitBranchLabel0};\n  }\n  .icon-container {\n    height:100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  .edge {\n    fill: none;\n  }\n  .eventWrapper  {\n   filter: brightness(120%);\n  }\n`;\nexport default getStyles;\n","// @ts-ignore: TODO Fix ts errors\nimport parser from './parser/timeline.jison';\nimport * as db from './timelineDb';\nimport renderer from './timelineRenderer';\nimport styles from './styles';\n\nexport const diagram = {\n  db,\n  renderer,\n  parser,\n  styles,\n};\n"],"names":["luminance","color","r","g","b","Color","_","isLight","isDark","parser","o","k","v","o2","l","length","$V0","$V1","$V2","$V3","$V4","$V5","$V6","$V7","$V8","$V9","$Va","$Vb","parser2","trace","yy","symbols_","terminals_","productions_","performAction","yytext","yyleng","yylineno","yystate","$$","_$","$0","$","push","getCommonDb","setDiagramTitle","substr","trim","setAccTitle","setAccDescription","addSection","addTask","addEvent","parseDirective","replace","table","defaultActions","parseError","str","hash","recoverable","error","Error","parse","input","self","stack","tstack","vstack","lstack","TERROR","EOF","args","slice","call","arguments","lexer2","Object","create","lexer","sharedState","prototype","hasOwnProperty","setInput","yylloc","yyloc","ranges","options","lex","token","pop","Array","getPrototypeOf","symbol","state","action","p","len","newState","expected","yyval","errStr","showPosition","join","text","match","line","loc","first_line","last_line","first_column","last_column","range","apply","concat","_input","_more","_backtrack","done","matched","conditionStack","offset","ch","lines","unput","split","oldLines","more","reject","backtrack_lexer","less","n","pastInput","past","upcomingInput","next","pre","c","test_match","indexed_rule","backup","matches","tempMatch","index","rules","_currentRules","i","flex","begin","condition","popState","conditions","topState","Math","abs","pushState","stateStackSize","yy_","$avoiding_name_collisions","YY_START","Parser","parser$1","currentSection","currentTaskId","sections","tasks","rawTasks","commonDb","statement","context","type","parseDirective$1","globalThis","clear","clear$1","txt","getSections","getTasks","allItemsProcessed","compileTasks","maxDepth","iterationCount","period","event","rawTask","id","section","task","score","events","currentTask","find","addTaskOrg","descr","newTask","description","classes","compileTask","pos","processed","allProcessed","entries","timelineDb","MAX_SECTIONS","drawRect","elem","rectData","rectElem","append","attr","x","y","fill","stroke","width","height","rx","ry","class","drawFace","element","faceData","radius","circleElement","cx","cy","face","smile","face2","arc$1","arc","startAngle","PI","endAngle","innerRadius","outerRadius","sad","ambivalent","drawCircle","circleData","title","drawText","textData","nText","textElem","style","anchor","span","textMargin","drawLabel","txtObject","genPoints","cut","polygon","labelMargin","drawSection","conf","rect","getNoteRect","num","_drawTextCandidateFunc","colour","taskCount","drawTask","center","maxHeight","drawBackgroundRect","bounds","startx","starty","stopx","stopy","lower","getTextObj","byText","content","textAttrs","_setTextAttrs","byTspan","taskFontSize","taskFontFamily","dy","byFo","body","f","toText","fromTextAttrsDict","key","textPlacement","initGraphics","graphics","wrap","each","word","text2","select","this","words","reverse","lineHeight","parseFloat","tspan","j","node","getComputedTextLength","drawNode","fullSection","nodeElem","bkgElem","bbox","getBBox","fontSize","padding","max","defaultBkg","getVirtualNodeHeight","remove","rd","svgDraw","draw","version","diagObj","getConfig","LEFT_MARGIN","leftMargin","_b","_a","db","log","securityLevel","sandboxElement","root","nodes","contentDocument","svg","tasks2","getDiagramTitle","sections2","maxSectionHeight","maxTaskHeight","depthY","sectionBeginY","masterX","masterY","sectionNumber","hasSections","forEach","sectionNode","number","sectionHeight","maxEventCount","maxEventLineLength","taskNode","taskHeight","maxEventLineLengthTemp","eventNode","tasksForSection","filter","sectionNodeWrapper","drawTasks","box","lineWrapper","setupGraphViewbox","_c","timeline","_d","useMaxWidth","diagram2","sectionColor","isWithoutSections","taskWrapper","lineLength","drawEvents","disableMulticolor","maxEventHeight","eventBeginY","eventWrapper","eventHeight","renderer","setConf","genSections","THEME_COLOR_LIMIT","lighten","darken","sw","getStyles","git0","gitBranchLabel0","styles","diagram"],"sourceRoot":""}